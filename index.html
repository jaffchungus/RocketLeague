<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gun Game</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 20px; height: 20px; transform: translate(-50%, -50%); color: red; font-size: 20px; text-align: center; pointer-events: none; }
    </style>
</head>
<body>
    <div id="crosshair">+</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script>
        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040);
        scene.add(ambientLight);
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        // Ground
        const groundGeometry = new THREE.PlaneGeometry(100, 100);
        const groundMaterial = new THREE.MeshBasicMaterial({ color: 0x8B4513 });
        const ground = new THREE.Mesh(groundGeometry, groundMaterial);
        ground.rotation.x = -Math.PI / 2;
        scene.add(ground);

        // Realistic gun (simulated with primitives)
        const gun = new THREE.Group();
        // Barrel
        const barrelGeometry = new THREE.CylinderGeometry(0.1, 0.1, 2, 32);
        const gunMaterial = new THREE.MeshBasicMaterial({ color: 0x333333 }); // Dark gray metal
        const barrel = new THREE.Mesh(barrelGeometry, gunMaterial);
        barrel.rotation.x = Math.PI / 2;
        barrel.position.z = 1;
        gun.add(barrel);
        // Handle
        const handleGeometry = new THREE.BoxGeometry(0.2, 0.8, 0.4);
        const handle = new THREE.Mesh(handleGeometry, gunMaterial);
        handle.position.set(0, -0.4, 0);
        gun.add(handle);
        // Trigger guard
        const triggerGuardGeometry = new THREE.TorusGeometry(0.2, 0.05, 16, 32, Math.PI);
        const triggerGuard = new THREE.Mesh(triggerGuardGeometry, gunMaterial);
        triggerGuard.position.set(0, -0.2, 0.2);
        triggerGuard.rotation.x = Math.PI / 2;
        gun.add(triggerGuard);
        gun.position.set(0, 1, -1); // Position in front of camera
        scene.add(gun);

        // Target
        let targetScale = 1;
        let targetDistance = 10;
        const targetGeometry = new THREE.SphereGeometry(targetScale, 32, 32);
        const targetMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
        let target = new THREE.Mesh(targetGeometry, targetMaterial);
        target.position.set((Math.random() - 0.5) * 20, targetScale, targetDistance);
        scene.add(target);

        // Camera positioning
        camera.position.set(0, 2, 0);
        camera.lookAt(0, 0, 10);

        // Gun movement controls
        const keys = { ArrowUp: false, ArrowDown: false, Space: false };
        document.addEventListener('keydown', (e) => { 
            if (e.key === ' ') keys.Space = true;
            else if (keys[e.key] !== undefined) keys[e.key] = true; 
        });
        document.addEventListener('keyup', (e) => { 
            if (e.key === ' ') keys.Space = false;
            else if (keys[e.key] !== undefined) keys[e.key] = false; 
        });

        // Shooting raycaster
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2(0, 0); // Center of screen

        // Game state
        let score = 0;

        // Animation loop
        function animate() {
            requestAnimationFrame(animate);

            // Gun movement (up/down only)
            if (keys.ArrowUp && gun.rotation.x > -Math.PI / 4) gun.rotation.x -= 0.05;  // Aim up
            if (keys.ArrowDown && gun.rotation.x < Math.PI / 4) gun.rotation.x += 0.05; // Aim down

            // Shooting
            if (keys.Space) {
                keys.Space = false; // Prevent continuous firing
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects([target]);
                if (intersects.length > 0) {
                    // Hit detected
                    score++;
                    scene.remove(target);
                    // Increase difficulty
                    targetScale *= 0.9; // Smaller
                    targetDistance += 2; // Farther
                    target = new THREE.Mesh(
                        new THREE.SphereGeometry(targetScale, 32, 32),
                        targetMaterial
                    );
                    target.position.set(
                        (Math.random() - 0.5) * 20,
                        targetScale,
                        targetDistance
                    );
                    scene.add(target);
                    console.log(`Score: ${score}`);
                }
            }

            renderer.render(scene, camera);
        }

        animate();

        // Window resize handler
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
