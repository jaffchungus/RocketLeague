<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gun Game with Phaser</title>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; background: #000; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.80.1/phaser.min.js"></script>
    <script>
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            physics: {
                default: 'arcade',
                arcade: { gravity: { y: 0 } }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        const game = new Phaser.Game(config);
        let gun, crosshair, targets, bullets, scoreText;
        let score = 0;
        let targetScale = 1;
        let targetDistance = 400;

        function preload() {
            // No external assets, using graphics instead
        }

        function create() {
            // Ground
            this.add.rectangle(400, 600, 800, 200, 0x8B4513).setOrigin(0.5, 1);

            // Realistic gun (simulated with shapes)
            gun = this.add.group();
            const barrel = this.add.rectangle(100, 300, 60, 10, 0x333333); // Barrel
            const handle = this.add.rectangle(70, 320, 10, 40, 0x333333); // Handle
            const triggerGuard = this.add.circle(80, 320, 10, 0x333333).setStrokeStyle(2, 0x333333); // Trigger guard
            gun.addMultiple([barrel, handle, triggerGuard]);
            gun.setDepth(1);

            // Crosshair
            crosshair = this.add.text(150, 300, '+', { fontSize: '24px', color: '#ff0000' }).setOrigin(0.5);

            // Bullets group
            bullets = this.physics.add.group({
                defaultKey: 'bullet',
                maxSize: 20
            });

            // Initial target
            targets = this.physics.add.group();
            spawnTarget(this);

            // Score text
            scoreText = this.add.text(16, 16, 'Score: 0', { fontSize: '20px', color: '#fff' });

            // Input
            this.input.keyboard.on('keydown-SPACE', shoot, this);
        }

        function update() {
            const cursors = this.input.keyboard.createCursorKeys();

            // Gun movement (up/down)
            let gunY = gun.getChildren()[0].y;
            if (cursors.up.isDown && gunY > 50) {
                gun.getChildren().forEach(child => child.y -= 5);
            }
            if (cursors.down.isDown && gunY < 550) {
                gun.getChildren().forEach(child => child.y += 5);
            }

            // Sync crosshair with gun
            crosshair.setPosition(150, gun.getChildren()[0].y);

            // Bullet movement
            bullets.children.each(bullet => {
                if (bullet.active && (bullet.x > 800 || bullet.x < 0)) {
                    bullet.setActive(false).setVisible(false);
                }
            });

            // Check collisions
            this.physics.overlap(bullets, targets, hitTarget, null, this);
        }

        function shoot() {
            const bullet = bullets.get(150, gun.getChildren()[0].y);
            if (bullet) {
                bullet.setActive(true).setVisible(true);
                bullet.setSize(10, 5).setDisplaySize(10, 5);
                bullet.setFillStyle(0xffff00); // Yellow bullet
                bullet.body.setVelocityX(600); // Shoot right
            }
        }

        function spawnTarget(scene) {
            const x = Phaser.Math.Between(500, 700);
            const y = Phaser.Math.Between(50, 550);
            const target = scene.physics.add.circle(x, y, 20 * targetScale, 0xff0000);
            targets.add(target);
        }

        function hitTarget(bullet, target) {
            bullet.setActive(false).setVisible(false);
            target.destroy();
            score++;
            scoreText.setText(`Score: ${score}`);
            
            // Increase difficulty
            targetScale *= 0.9; // Smaller
            targetDistance += 50; // Farther (affects spawn range)
            spawnTarget(this);
        }
    </script>
</body>
</html>
